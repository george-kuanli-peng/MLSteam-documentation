format: v0.1
name: PoC workflow
defaults:
  flavor: micro
steps:
  - name: checkout code
    type: checkout
    needs: null
  - name: preproc
    type: docker_run
    needs: pre
    image: ubuntu:20.04
    flavor: small
    run: |
      pip3 install -r requirements.txt
      python3 preproc.py
  - name: build img
    type: docker_build
    needs: pre
    tags: ["my_chatbot:ci"]
  - name: run model endpoint
    type: template_run
    needs:
      - preproc
      - build img
    template:
      name: my_chatbot
      type: webapp
    ports:
      - 80
